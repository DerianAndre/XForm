/*!
 * XForm
 * A simple, lightweight, and automated way to manage forms with fetch or XHR.
 * @version    : 1.0.0
 * @author     : DerianAndre <hola@derianandre.com>
 * @repository : https://github.com/DerianAndre/XForm.git
 * @built      : 9/6/2021
 * @license    : MIT
 */
!function(t,e){"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?module.exports=e():t.XForm=e()}(this,function(){const i="[data-xform]",r="[data-xform-submit]",s="[data-xform-reset]",a=window.location.href,o="post",n=!0,c=!0,h="is-valid",l="is-invalid",f=!0,u=null,m="name",d="[data-xform-item]",g="[data-xform-ignore]",y="input, select, textarea",v={file:"files",checkbox:"checked",default:"value"};function b(t=i,e={}){"object"==typeof t?e=t:e.selector=t;e=k({selector:i,method:o,url:a,submit:r,reset:s,json:n,item:{selectAll:f,selector:d,ignore:g,key:m,default:u},classes:{enable:c,valid:h,invalid:l}},e);return this.config=e,this.data={},this.dataJSON={},this.formData=new FormData,this.items={array:[],object:{}},this.length=0,this.ready=!1,this.form=null,this.submit=null,this.reset=null,this.init=p,this.check=w,this.$xhr=A,this.$fetch=j,this}function p(){var r=document.querySelector(this.config.selector);if(!r)throw new Error("[XForm] Form selector missing");var t=this.config.item.selectAll?y:this.config.item.selector,e=Array.from(r.querySelectorAll(t)),i=r.querySelector(this.config.submit),t=r.querySelector(this.config.reset);return e.forEach(t=>{if(!t.hasAttribute(this.config.item.ignore.slice(1,-1))&&!t.classList.contains(this.config.item.ignore)){var e=t.getAttribute(this.config.item.key);if(!e)throw new Error("[XForm] Item key missing");var i=Array.from(r.querySelectorAll(`[${this.config.item.key}="${e}"]`));this.data[e]=this.config.item.default,this.items.array.push(t),this.items.object[e]=1===i.length?t:i}}),this.form=r,this.submit=i||null,this.reset=t||null,this.length=this.items.array.length,this}function w(){var s=0;this.formData=new FormData,this.items.array.forEach(t=>{var e=t.getAttribute(this.config.item.key);if(!e)throw new Error("[XForm] Item does not have a key");var i=t.getAttribute("type")||"default",r=function(t,e,i){if(!t||!e||!i)return null;"radio"===i&&(r=Array.from(t.form.querySelectorAll(`[name="${e.name}"]`)),e=r.find(t=>t.checked));var r=e[v[i]]||e[v.default];r=r||t.config.item.default,"checkbox"===i&&(r=!!e.checked&&e.value);return r}(this,t,i);t.value&&""!=t.value?this.config.classes.enable&&(t.classList.add(this.config.classes.valid),t.classList.remove(this.config.classes.invalid)):t.hasAttribute("required")&&(s++,this.config.classes.enable&&(t.classList.add(this.config.classes.invalid),t.classList.remove(this.config.classes.valid))),this.data[e]=r,"file"==i?0<t.files.length?Array.from(r).forEach(t=>{this.formData.append(`${e}[]`,t)}):this.formData.append(e,null):this.formData.append(e,r)});var t=JSON.stringify(this.data);return this.dataJSON=t,this.formData.append("dataJSON",t),0===s&&(this.ready=!0),this}function A(t){var e=new XMLHttpRequest;e.open(this.config.method,this.config.url,!0),e.send(this.formData),e.onreadystatechange=function(){if(4===e.readyState&&200===e.status){try{e.json=JSON.parse(e.responseText),e.error=!1}catch(t){e.json=!1,e.error=t}return t(e)}}}async function j(t={}){t=k({method:this.config.method||o,body:this.formData||null},t);const e=await fetch(this.config.url,t);try{e.json=await e.json(),e.error=!1}catch(t){e.json=!1,e.error=t}return e}function k(t,e){if(Object(e)!==e)return e;for(var i in Object(t)!==t&&(t={}),e)t[i]=k(t[i],e[i]);return t}return function(t,e){return new b(t,e)}});